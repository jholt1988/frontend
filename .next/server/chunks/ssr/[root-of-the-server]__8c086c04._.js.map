{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 111, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/plabr/PDL_APP/v2/frontend/src/app/services/axiosInstance.js"],"sourcesContent":["// src/services/axiosInstance.js\r\n\r\nimport axios from 'axios';\r\n\r\n\r\n// Create base axios instance\r\nconst api = axios.create({\r\n  baseURL: process.env.API_URL || 'http://localhost:5000/api/v1',\r\n  headers: {\r\n    'Content-Type': 'application/json',\r\n\r\n  },\r\n  \r\n});\r\n\r\n// Automatically attach token (if exists)\r\napi.interceptors.request.use((config) => {\r\n  const token = localStorage.getItem('token');\r\n  if (token) {\r\n    config.headers.Authorization = `Bearer ${token}`;\r\n  }\r\n  return config;\r\n});\r\n\r\n// Optional: Global error handler (e.g., auto logout on 401)\r\napi.interceptors.response.use(\r\n  (response) => response,\r\n  (error) => {\r\n    if (error.response && error.response.status === 401) {\r\n      console.warn('â›” Unauthorized - logging out');\r\n      localStorage.removeItem('token');\r\n      window.location.href = '/login';\r\n    }\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\nexport default api;\r\n"],"names":[],"mappings":"AAAA,gCAAgC;;;;AAEhC;;AAGA,6BAA6B;AAC7B,MAAM,MAAM,qIAAA,CAAA,UAAK,CAAC,MAAM,CAAC;IACvB,SAAS,QAAQ,GAAG,CAAC,OAAO,IAAI;IAChC,SAAS;QACP,gBAAgB;IAElB;AAEF;AAEA,yCAAyC;AACzC,IAAI,YAAY,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;IAC5B,MAAM,QAAQ,aAAa,OAAO,CAAC;IACnC,IAAI,OAAO;QACT,OAAO,OAAO,CAAC,aAAa,GAAG,CAAC,OAAO,EAAE,OAAO;IAClD;IACA,OAAO;AACT;AAEA,4DAA4D;AAC5D,IAAI,YAAY,CAAC,QAAQ,CAAC,GAAG,CAC3B,CAAC,WAAa,UACd,CAAC;IACC,IAAI,MAAM,QAAQ,IAAI,MAAM,QAAQ,CAAC,MAAM,KAAK,KAAK;QACnD,QAAQ,IAAI,CAAC;QACb,aAAa,UAAU,CAAC;QACxB,OAAO,QAAQ,CAAC,IAAI,GAAG;IACzB;IACA,OAAO,QAAQ,MAAM,CAAC;AACxB;uCAGa","debugId":null}},
    {"offset": {"line": 148, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/plabr/PDL_APP/v2/frontend/src/app/services/apiService.js"],"sourcesContent":["// src/services/apiService.js\r\nimport api from './axiosInstance';\r\n\r\nexport const getPayments = async () => {\r\n  const res = await api.get('/payments/mine');\r\n  return res.data;\r\n};\r\n\r\nexport const createMaintenanceRequest = async (data) => {\r\n  const res = await api.post('/maintenance', data);\r\n  return res.data;\r\n};\r\n\r\nexport const getMaintenanceRequests = async () => {\r\n  const res = await api.get('/maintenance');\r\n  return res.data;\r\n};\r\n\r\nexport const getTenantProfile = async (userId) => {\r\n  const res = await api.get(`/tenant-profile/${userId}`);\r\n  return res.data;\r\n};\r\n\r\nexport const createTenantProfile = async (profile) => {\r\n  const res = await api.post('/tenant-profile', profile);\r\n  return res.data;\r\n};\r\n\r\nexport const updateTenantProfile = async (userId, profile) => {\r\n  const res = await api.put(`/tenant-profile/${userId}`, profile);\r\n  return res.data;\r\n};\r\n\r\nexport const createPayment = async (data) => {\r\n    const res = await api.post('/payments', data);\r\n    return res.data;\r\n  };\r\n  \r\n  export const searchUsers = async (query) => {\r\n    const res = await api.get(`/users?search=${encodeURIComponent(query)}`);\r\n    return res.data; // assumes it returns [{ id, name, email }]\r\n  };\r\n\r\n  export const getMyPayments = async () => {\r\n    const res = await api.get('/payments/mine');\r\n    return res.data;\r\n  };\r\n  \r\n  export const getDashboardSummary = async () => {\r\n    const res = await api.get('/dashboard/summary');\r\n    return res.data;\r\n  };\r\n\r\n  export const getDashboardStats = async () => {\r\n    const res = await api.get('/dashboard/stats');\r\n    return res.data;\r\n  };\r\n  \r\n  export const getTenantPayments = async (id) => {\r\n  const res = await api.get(`/tenants/${id}/payments`);\r\n  return res.data;\r\n};\r\n\r\nexport const getTenantMaintenance = async (id) => {\r\n  const res = await api.get(`/tenants/${id}/maintenance`);\r\n  return res.data;\r\n};\r\n\r\nexport const getTenants = async (search = '') => {\r\n    const res = await api.get(`/users?role=tenant&search=${encodeURIComponent(search)}`);\r\n    return res.data;\r\n  };\r\n  "],"names":[],"mappings":"AAAA,6BAA6B;;;;;;;;;;;;;;;;;AAC7B;;AAEO,MAAM,cAAc;IACzB,MAAM,MAAM,MAAM,uIAAA,CAAA,UAAG,CAAC,GAAG,CAAC;IAC1B,OAAO,IAAI,IAAI;AACjB;AAEO,MAAM,2BAA2B,OAAO;IAC7C,MAAM,MAAM,MAAM,uIAAA,CAAA,UAAG,CAAC,IAAI,CAAC,gBAAgB;IAC3C,OAAO,IAAI,IAAI;AACjB;AAEO,MAAM,yBAAyB;IACpC,MAAM,MAAM,MAAM,uIAAA,CAAA,UAAG,CAAC,GAAG,CAAC;IAC1B,OAAO,IAAI,IAAI;AACjB;AAEO,MAAM,mBAAmB,OAAO;IACrC,MAAM,MAAM,MAAM,uIAAA,CAAA,UAAG,CAAC,GAAG,CAAC,CAAC,gBAAgB,EAAE,QAAQ;IACrD,OAAO,IAAI,IAAI;AACjB;AAEO,MAAM,sBAAsB,OAAO;IACxC,MAAM,MAAM,MAAM,uIAAA,CAAA,UAAG,CAAC,IAAI,CAAC,mBAAmB;IAC9C,OAAO,IAAI,IAAI;AACjB;AAEO,MAAM,sBAAsB,OAAO,QAAQ;IAChD,MAAM,MAAM,MAAM,uIAAA,CAAA,UAAG,CAAC,GAAG,CAAC,CAAC,gBAAgB,EAAE,QAAQ,EAAE;IACvD,OAAO,IAAI,IAAI;AACjB;AAEO,MAAM,gBAAgB,OAAO;IAChC,MAAM,MAAM,MAAM,uIAAA,CAAA,UAAG,CAAC,IAAI,CAAC,aAAa;IACxC,OAAO,IAAI,IAAI;AACjB;AAEO,MAAM,cAAc,OAAO;IAChC,MAAM,MAAM,MAAM,uIAAA,CAAA,UAAG,CAAC,GAAG,CAAC,CAAC,cAAc,EAAE,mBAAmB,QAAQ;IACtE,OAAO,IAAI,IAAI,EAAE,2CAA2C;AAC9D;AAEO,MAAM,gBAAgB;IAC3B,MAAM,MAAM,MAAM,uIAAA,CAAA,UAAG,CAAC,GAAG,CAAC;IAC1B,OAAO,IAAI,IAAI;AACjB;AAEO,MAAM,sBAAsB;IACjC,MAAM,MAAM,MAAM,uIAAA,CAAA,UAAG,CAAC,GAAG,CAAC;IAC1B,OAAO,IAAI,IAAI;AACjB;AAEO,MAAM,oBAAoB;IAC/B,MAAM,MAAM,MAAM,uIAAA,CAAA,UAAG,CAAC,GAAG,CAAC;IAC1B,OAAO,IAAI,IAAI;AACjB;AAEO,MAAM,oBAAoB,OAAO;IACxC,MAAM,MAAM,MAAM,uIAAA,CAAA,UAAG,CAAC,GAAG,CAAC,CAAC,SAAS,EAAE,GAAG,SAAS,CAAC;IACnD,OAAO,IAAI,IAAI;AACjB;AAEO,MAAM,uBAAuB,OAAO;IACzC,MAAM,MAAM,MAAM,uIAAA,CAAA,UAAG,CAAC,GAAG,CAAC,CAAC,SAAS,EAAE,GAAG,YAAY,CAAC;IACtD,OAAO,IAAI,IAAI;AACjB;AAEO,MAAM,aAAa,OAAO,SAAS,EAAE;IACxC,MAAM,MAAM,MAAM,uIAAA,CAAA,UAAG,CAAC,GAAG,CAAC,CAAC,0BAA0B,EAAE,mBAAmB,SAAS;IACnF,OAAO,IAAI,IAAI;AACjB","debugId":null}},
    {"offset": {"line": 237, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/plabr/PDL_APP/v2/frontend/src/app/components/ExportControls.jsx"],"sourcesContent":["'use client';\r\n\r\nimport { saveAs } from 'file-saver';\r\nimport html2canvas from 'html2canvas';\r\nimport jsPDF from 'jspdf';\r\nimport Papa from 'papaparse';\r\n\r\nexport default function ExportControls({ data, filename, chartRef }) {\r\n  const exportCSV = () => {\r\n    const csv = Papa.unparse(data);\r\n    const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });\r\n    saveAs(blob, `${filename}.csv`);\r\n  };\r\n\r\n  const exportPDF = async () => {\r\n    if (!chartRef?.current) return;\r\n\r\n    const canvas = await html2canvas(chartRef.current);\r\n    const imgData = canvas.toDataURL('image/png');\r\n    const pdf = new jsPDF('p', 'mm', 'a4');\r\n    const width = pdf.internal.pageSize.getWidth();\r\n    const height = (canvas.height * width) / canvas.width;\r\n    pdf.addImage(imgData, 'PNG', 0, 10, width, height);\r\n    pdf.save(`${filename}.pdf`);\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex gap-3 mt-4\">\r\n      <button onClick={exportCSV} className=\"btn btn-secondary\">Export CSV</button>\r\n      <button onClick={exportPDF} className=\"btn btn-secondary\">Export PDF</button>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AALA;;;;;;AAOe,SAAS,eAAe,EAAE,IAAI,EAAE,QAAQ,EAAE,QAAQ,EAAE;IACjE,MAAM,YAAY;QAChB,MAAM,MAAM,sIAAA,CAAA,UAAI,CAAC,OAAO,CAAC;QACzB,MAAM,OAAO,IAAI,KAAK;YAAC;SAAI,EAAE;YAAE,MAAM;QAA0B;QAC/D,CAAA,GAAA,yJAAA,CAAA,SAAM,AAAD,EAAE,MAAM,GAAG,SAAS,IAAI,CAAC;IAChC;IAEA,MAAM,YAAY;QAChB,IAAI,CAAC,UAAU,SAAS;QAExB,MAAM,SAAS,MAAM,CAAA,GAAA,yJAAA,CAAA,UAAW,AAAD,EAAE,SAAS,OAAO;QACjD,MAAM,UAAU,OAAO,SAAS,CAAC;QACjC,MAAM,MAAM,IAAI,mJAAA,CAAA,UAAK,CAAC,KAAK,MAAM;QACjC,MAAM,QAAQ,IAAI,QAAQ,CAAC,QAAQ,CAAC,QAAQ;QAC5C,MAAM,SAAS,AAAC,OAAO,MAAM,GAAG,QAAS,OAAO,KAAK;QACrD,IAAI,QAAQ,CAAC,SAAS,OAAO,GAAG,IAAI,OAAO;QAC3C,IAAI,IAAI,CAAC,GAAG,SAAS,IAAI,CAAC;IAC5B;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAO,SAAS;gBAAW,WAAU;0BAAoB;;;;;;0BAC1D,8OAAC;gBAAO,SAAS;gBAAW,WAAU;0BAAoB;;;;;;;;;;;;AAGhE","debugId":null}},
    {"offset": {"line": 305, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/plabr/PDL_APP/v2/frontend/src/app/features/AdminDashboard.jsx"],"sourcesContent":["'use client';\r\n\r\nimport { useEffect, useState, useContext, useRef} from 'react';\r\nimport  AuthContext  from '@/context/AuthContext';\r\nimport { getDashboardSummary } from '@/services/apiService';\r\nimport { getDashboardStats } from '@/services/apiService';\r\nimport { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, BarChart, Bar } from 'recharts';\r\nimport ExportControls from '@/components/ExportControls';\r\n\r\nexport default function AdminDashboard() {\r\n  const { user } = useContext(AuthContext);\r\n  const [summary, setSummary] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [stats, getStats] = useState(null)\r\n  const chartRef = useRef();\r\n\r\n  useEffect(() => {\r\n    if (user?.role === 'admin' || user?.role === 'staff') {\r\n      getDashboardSummary()\r\n        .then(setSummary)\r\n        .catch((err) => console.error('Failed to fetch dashboard summary:', err))\r\n        .finally(() => setLoading(false));\r\n\r\n        getDashboardStats()\r\n        .then(getStats)\r\n        .catch((err) => console.error('Failed to fetch dashboard stats:', err)) \r\n        .finally(() => setLoading(false));\r\n    }\r\n  }, [user]);\r\n\r\n  if (!user || !['admin', 'staff'].includes(user.role)) {\r\n    return <p className=\"text-red-500\">Unauthorized</p>;\r\n  }\r\n\r\n  if (loading) return <p>Loading dashboard...</p>;\r\n\r\n  return (\r\n    <div className=\"max-w-6xl mx-auto bg-white p-6 rounded shadow\">\r\n      <h2 className=\"text-2xl font-bold mb-4\">Admin Dashboard</h2>\r\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n        <StatCard label=\"Total Tenants\" value={summary.totalTenants} />\r\n        <StatCard label=\"Payments Made\" value={summary.totalPayments} />\r\n        <StatCard label=\"Amount Received\" value={`$${summary.totalAmountPaid.toFixed(2)}`} />\r\n        <StatCard label=\"Open Maintenance\" value={summary.openMaintenance} />\r\n        <StatCard label=\"Pending Payments\" value={summary.pendingPayments} />\r\n      </div>\r\n      {stats && (\r\n  <div ref={chartRef} className=\"grid grid-cols-1 md:grid-cols-2 gap-6 mt-6\">\r\n    <div className=\"bg-white p-4 rounded shadow\">\r\n      <h3 className=\"text-lg font-semibold mb-2\">Monthly Payments</h3>\r\n      <ResponsiveContainer width=\"100%\" height={250}>\r\n        <LineChart data={stats.monthlyPayments}>\r\n          <CartesianGrid stroke=\"#eee\" strokeDasharray=\"5 5\" />\r\n          <XAxis dataKey=\"month\" />\r\n          <YAxis />\r\n          <Tooltip />\r\n          <Line type=\"monotone\" dataKey=\"total\" stroke=\"#3b82f6\" />\r\n        </LineChart>\r\n      </ResponsiveContainer>\r\n    </div>\r\n\r\n    <div className=\"bg-white p-4 rounded shadow\">\r\n      <h3 className=\"text-lg font-semibold mb-2\">Maintenance Volume</h3>\r\n      <ResponsiveContainer width=\"100%\" height={250}>\r\n        <BarChart data={stats.maintenanceByMonth}>\r\n          <CartesianGrid strokeDasharray=\"3 3\" />\r\n          <XAxis dataKey=\"month\" />\r\n          <YAxis />\r\n          <Tooltip />\r\n          <Bar dataKey=\"count\" fill=\"#10b981\" />\r\n        </BarChart>\r\n      </ResponsiveContainer>\r\n    </div>\r\n  </div>\r\n)}\r\n        <div className=\"mt-6\">\r\n            <h3 className=\"text-lg font-semibold mb-2\">Export Data</h3>\r\n            <ExportControls />\r\n        </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction StatCard({ label, value }) {\r\n  return (\r\n    <div className=\"bg-gray-100 p-4 rounded shadow text-center\">\r\n      <p className=\"text-xl font-semibold text-gray-800\">{value}</p>\r\n      <p className=\"text-sm text-gray-600\">{label}</p>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}